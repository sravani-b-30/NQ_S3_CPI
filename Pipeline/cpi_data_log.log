2024-11-26 14:12:27,247 - __main__ - INFO - Processing brand: NAPQUEEN
2024-11-26 14:12:33,157 - __main__ - INFO - Successfully executed query for keyword IDs.
2024-11-26 14:12:33,256 - __main__ - INFO - Data successfully retrieved from database.
2024-11-26 14:12:33,416 - __main__ - INFO - Process 1: Finding Keyword IDs
2024-11-26 14:12:33,417 - __main__ - INFO - Filtered active keywords for brand 'NAPQUEEN'. Total records found: 24893
2024-11-26 14:12:33,422 - __main__ - INFO - Database connection closed.
2024-11-26 14:12:33,430 - __main__ - INFO - Starting fetch_keyword_ids for given keywords.
2024-11-26 14:12:42,602 - __main__ - INFO - Successfully fetched keyword IDs from the database.
2024-11-26 14:12:42,616 - __main__ - INFO - Initial DataFrame info:
2024-11-26 14:12:42,654 - __main__ - INFO - None
2024-11-26 14:12:42,655 - __main__ - INFO - Number of unique keyword IDs: 431
2024-11-26 14:12:44,135 - __main__ - INFO - Fetching SERP data from 2024-08-29 to 2024-11-27
2024-11-26 14:12:44,136 - __main__ - INFO - start date: 2024-08-29
2024-11-26 14:12:44,143 - __main__ - INFO - end date: 2024-09-05
2024-11-26 14:12:45,164 - __main__ - INFO - 2024-08-29
2024-11-26 14:12:45,165 - __main__ - INFO - start date: 2024-09-05
2024-11-26 14:12:45,166 - __main__ - INFO - end date: 2024-09-12
2024-11-26 14:12:45,591 - __main__ - INFO - 2024-09-05
2024-11-26 14:12:45,592 - __main__ - INFO - start date: 2024-09-12
2024-11-26 14:12:45,593 - __main__ - INFO - end date: 2024-09-19
2024-11-26 14:12:45,999 - __main__ - INFO - 2024-09-12
2024-11-26 14:12:45,999 - __main__ - INFO - start date: 2024-09-19
2024-11-26 14:12:45,999 - __main__ - INFO - end date: 2024-09-26
2024-11-26 14:13:33,074 - __main__ - INFO - 2024-09-19
2024-11-26 14:13:33,075 - __main__ - INFO - start date: 2024-09-26
2024-11-26 14:13:33,075 - __main__ - INFO - end date: 2024-10-03
2024-11-26 14:15:14,778 - __main__ - INFO - 2024-09-26
2024-11-26 14:15:14,780 - __main__ - INFO - start date: 2024-10-03
2024-11-26 14:15:14,780 - __main__ - INFO - end date: 2024-10-10
2024-11-26 14:16:58,950 - __main__ - INFO - 2024-10-03
2024-11-26 14:16:58,951 - __main__ - INFO - start date: 2024-10-10
2024-11-26 14:16:58,951 - __main__ - INFO - end date: 2024-10-17
2024-11-26 14:19:09,331 - __main__ - INFO - 2024-10-10
2024-11-26 14:19:09,332 - __main__ - INFO - start date: 2024-10-17
2024-11-26 14:19:09,332 - __main__ - INFO - end date: 2024-10-24
2024-11-26 14:21:10,701 - __main__ - INFO - 2024-10-17
2024-11-26 14:21:10,701 - __main__ - INFO - start date: 2024-10-24
2024-11-26 14:21:10,701 - __main__ - INFO - end date: 2024-10-31
2024-11-26 14:22:22,593 - __main__ - INFO - 2024-10-24
2024-11-26 14:22:22,593 - __main__ - INFO - start date: 2024-10-31
2024-11-26 14:22:22,593 - __main__ - INFO - end date: 2024-11-07
2024-11-26 14:22:53,701 - __main__ - INFO - 2024-10-31
2024-11-26 14:22:53,702 - __main__ - INFO - start date: 2024-11-07
2024-11-26 14:22:53,702 - __main__ - INFO - end date: 2024-11-14
2024-11-26 14:23:26,125 - __main__ - INFO - 2024-11-07
2024-11-26 14:23:26,125 - __main__ - INFO - start date: 2024-11-14
2024-11-26 14:23:26,125 - __main__ - INFO - end date: 2024-11-21
2024-11-26 14:24:46,154 - __main__ - INFO - 2024-11-14
2024-11-26 14:24:46,154 - __main__ - INFO - start date: 2024-11-21
2024-11-26 14:24:46,154 - __main__ - INFO - end date: 2024-11-27
2024-11-26 14:25:53,587 - __main__ - INFO - 2024-11-21
2024-11-26 14:26:02,373 - __main__ - INFO - Process 2: Finding SERP Data
2024-11-26 14:26:03,229 - __main__ - INFO - Total unique product IDs: 25648
2024-11-26 14:26:03,229 - __main__ - INFO - Using chunk size: 2564
2024-11-26 14:26:05,164 - __main__ - INFO - Processing chunk 1: 2564 products
2024-11-26 14:26:23,054 - __main__ - INFO - Processing chunk 2: 2564 products
2024-11-26 14:26:41,066 - __main__ - INFO - Processing chunk 3: 2564 products
2024-11-26 14:27:06,293 - __main__ - INFO - Processing chunk 4: 2564 products
2024-11-26 14:27:28,770 - __main__ - INFO - Processing chunk 5: 2564 products
2024-11-26 14:27:52,181 - __main__ - INFO - Processing chunk 6: 2564 products
2024-11-26 14:28:11,471 - __main__ - INFO - Processing chunk 7: 2564 products
2024-11-26 14:28:30,555 - __main__ - INFO - Processing chunk 8: 2564 products
2024-11-26 14:28:48,332 - __main__ - INFO - Processing chunk 9: 2564 products
2024-11-26 14:29:07,930 - __main__ - INFO - Processing chunk 10: 2564 products
2024-11-26 14:29:34,677 - __main__ - INFO - Processing chunk 11: 8 products
2024-11-26 14:29:54,595 - botocore.hooks - DEBUG - Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-11-26 14:29:54,600 - botocore.hooks - DEBUG - Changing event name from before-call.apigateway to before-call.api-gateway
2024-11-26 14:29:54,602 - botocore.hooks - DEBUG - Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-11-26 14:29:54,603 - botocore.hooks - DEBUG - Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-11-26 14:29:54,604 - botocore.hooks - DEBUG - Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-11-26 14:29:54,605 - botocore.hooks - DEBUG - Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-11-26 14:29:54,606 - botocore.hooks - DEBUG - Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-11-26 14:29:54,608 - botocore.hooks - DEBUG - Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-11-26 14:29:54,608 - botocore.hooks - DEBUG - Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-11-26 14:29:54,608 - botocore.hooks - DEBUG - Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-11-26 14:29:54,608 - botocore.hooks - DEBUG - Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-11-26 14:29:54,909 - botocore.utils - DEBUG - IMDS ENDPOINT: http://169.254.169.254/
2024-11-26 14:29:54,921 - botocore.credentials - DEBUG - Looking for credentials via: env
2024-11-26 14:29:54,930 - botocore.credentials - DEBUG - Looking for credentials via: assume-role
2024-11-26 14:29:54,930 - botocore.credentials - DEBUG - Looking for credentials via: assume-role-with-web-identity
2024-11-26 14:29:54,930 - botocore.credentials - DEBUG - Looking for credentials via: sso
2024-11-26 14:29:54,931 - botocore.credentials - DEBUG - Looking for credentials via: shared-credentials-file
2024-11-26 14:29:54,931 - botocore.credentials - DEBUG - Looking for credentials via: custom-process
2024-11-26 14:29:54,931 - botocore.credentials - DEBUG - Looking for credentials via: config-file
2024-11-26 14:29:54,931 - botocore.credentials - DEBUG - Looking for credentials via: ec2-credentials-file
2024-11-26 14:29:54,931 - botocore.credentials - DEBUG - Looking for credentials via: boto-config
2024-11-26 14:29:54,931 - botocore.credentials - DEBUG - Looking for credentials via: container-role
2024-11-26 14:29:54,932 - botocore.credentials - DEBUG - Looking for credentials via: iam-role
2024-11-26 14:29:54,939 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 169.254.169.254:80
2024-11-26 14:29:55,953 - botocore.utils - DEBUG - Caught retryable HTTP exception while making metadata service request to http://169.254.169.254/latest/api/token: Connect timeout on endpoint URL: "http://169.254.169.254/latest/api/token"
Traceback (most recent call last):
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: timed out

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\httpsession.py", line 464, in send
    urllib_response = conn.urlopen(
                      ^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connectionpool.py", line 847, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\retry.py", line 445, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connectionpool.py", line 793, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connectionpool.py", line 496, in _make_request
    conn.request(
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\awsrequest.py", line 96, in request
    rval = super().request(method, url, body, headers, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 400, in request
    self.endheaders()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\client.py", line 1298, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\awsrequest.py", line 123, in _send_output
    self.send(msg)
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\awsrequest.py", line 223, in send
    return super().send(str)
           ^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\client.py", line 996, in send
    self.connect()
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 238, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 207, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<botocore.awsrequest.AWSHTTPConnection object at 0x0000019074981ED0>, 'Connection to 169.254.169.254 timed out. (connect timeout=1)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\utils.py", line 458, in _fetch_metadata_token
    response = self._session.send(request.prepare())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\httpsession.py", line 499, in send
    raise ConnectTimeoutError(endpoint_url=request.url, error=e)
botocore.exceptions.ConnectTimeoutError: Connect timeout on endpoint URL: "http://169.254.169.254/latest/api/token"
2024-11-26 14:29:56,169 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (2): 169.254.169.254:80
2024-11-26 14:29:57,178 - botocore.utils - DEBUG - Caught retryable HTTP exception while making metadata service request to http://169.254.169.254/latest/meta-data/iam/security-credentials/: Connect timeout on endpoint URL: "http://169.254.169.254/latest/meta-data/iam/security-credentials/"
Traceback (most recent call last):
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: timed out

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\httpsession.py", line 464, in send
    urllib_response = conn.urlopen(
                      ^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connectionpool.py", line 847, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\retry.py", line 445, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connectionpool.py", line 793, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connectionpool.py", line 496, in _make_request
    conn.request(
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\awsrequest.py", line 96, in request
    rval = super().request(method, url, body, headers, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 400, in request
    self.endheaders()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\client.py", line 1298, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\awsrequest.py", line 123, in _send_output
    self.send(msg)
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\awsrequest.py", line 223, in send
    return super().send(str)
           ^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\client.py", line 996, in send
    self.connect()
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 238, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 207, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<botocore.awsrequest.AWSHTTPConnection object at 0x000001900B216D90>, 'Connection to 169.254.169.254 timed out. (connect timeout=1)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\utils.py", line 513, in _get_request
    response = self._session.send(request.prepare())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\httpsession.py", line 499, in send
    raise ConnectTimeoutError(endpoint_url=request.url, error=e)
botocore.exceptions.ConnectTimeoutError: Connect timeout on endpoint URL: "http://169.254.169.254/latest/meta-data/iam/security-credentials/"
2024-11-26 14:29:57,188 - botocore.utils - DEBUG - Max number of attempts exceeded (1) when attempting to retrieve data from metadata service.
2024-11-26 14:29:57,205 - botocore.loaders - DEBUG - Loading JSON file: C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\data\endpoints.json
2024-11-26 14:29:57,233 - botocore.loaders - DEBUG - Loading JSON file: C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\data\sdk-default-configuration.json
2024-11-26 14:29:57,235 - botocore.hooks - DEBUG - Event choose-service-name: calling handler <function handle_service_name_alias at 0x00000190569A9440>
2024-11-26 14:29:57,704 - botocore.loaders - DEBUG - Loading JSON file: C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\data\s3\2006-03-01\service-2.json.gz
2024-11-26 14:29:57,822 - botocore.loaders - DEBUG - Loading JSON file: C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\data\s3\2006-03-01\endpoint-rule-set-1.json.gz
2024-11-26 14:29:57,833 - botocore.loaders - DEBUG - Loading JSON file: C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\data\partitions.json
2024-11-26 14:29:57,836 - botocore.hooks - DEBUG - Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x0000019056906F20>
2024-11-26 14:29:57,836 - botocore.hooks - DEBUG - Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x000001902200ECA0>
2024-11-26 14:29:58,079 - botocore.hooks - DEBUG - Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x0000019056906CA0>
2024-11-26 14:29:58,081 - botocore.configprovider - DEBUG - Looking for endpoint for s3 via: environment_service
2024-11-26 14:29:58,081 - botocore.configprovider - DEBUG - Looking for endpoint for s3 via: environment_global
2024-11-26 14:29:58,082 - botocore.configprovider - DEBUG - Looking for endpoint for s3 via: config_service
2024-11-26 14:29:58,082 - botocore.configprovider - DEBUG - Looking for endpoint for s3 via: config_global
2024-11-26 14:29:58,082 - botocore.configprovider - DEBUG - No configured endpoint found.
2024-11-26 14:29:58,084 - botocore.endpoint - DEBUG - Setting s3 timeout as (60, 60)
2024-11-26 14:29:58,095 - botocore.loaders - DEBUG - Loading JSON file: C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\data\_retry.json
2024-11-26 14:29:58,096 - botocore.client - DEBUG - Registering retry handlers for service: s3
2024-11-26 14:29:58,098 - botocore.utils - DEBUG - Registering S3 region redirector handler
2024-11-26 14:29:58,099 - botocore.utils - DEBUG - Registering S3Express Identity Resolver
2024-11-26 14:29:58,166 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x00000190569E8C20>
2024-11-26 14:29:58,167 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x00000190569CBEC0>
2024-11-26 14:29:58,167 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x00000190569E9620>
2024-11-26 14:29:58,168 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x00000190569CBE20>
2024-11-26 14:29:58,168 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x00000190569EA020>
2024-11-26 14:29:58,169 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x0000019056A7D110>>
2024-11-26 14:29:58,169 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x0000019056A7E910>>
2024-11-26 14:29:58,169 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x00000190569CBC40>
2024-11-26 14:29:58,169 - botocore.hooks - DEBUG - Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x00000190569EA200>
2024-11-26 14:29:58,170 - botocore.hooks - DEBUG - Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x0000019056A7D110>>
2024-11-26 14:29:58,172 - botocore.regions - DEBUG - Calling endpoint provider with parameters: {'Bucket': 'anarix-cpi', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'NAPQUEEN/asin_keyword_id_mapping.csv', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-11-26 14:29:58,173 - botocore.regions - DEBUG - Endpoint provider result: https://anarix-cpi.s3.amazonaws.com
2024-11-26 14:29:58,173 - botocore.regions - DEBUG - Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-11-26 14:29:58,174 - botocore.regions - DEBUG - Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-11-26 14:29:58,174 - botocore.hooks - DEBUG - Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x0000019056843BA0>
2024-11-26 14:29:58,178 - botocore.hooks - DEBUG - Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x00000190569E8220>
2024-11-26 14:29:58,183 - botocore.handlers - DEBUG - Adding expect 100 continue header to request.
2024-11-26 14:29:58,184 - botocore.hooks - DEBUG - Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x000001900066D6D0>>
2024-11-26 14:29:58,184 - botocore.hooks - DEBUG - Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x00000190569CA480>
2024-11-26 14:29:58,184 - botocore.hooks - DEBUG - Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x00000190569E9760>
2024-11-26 14:29:58,184 - botocore.endpoint - DEBUG - Making request for OperationModel(name=PutObject) with params: {'url_path': '/NAPQUEEN/asin_keyword_id_mapping.csv', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/windows#10 md/arch#amd64 lang/python#3.11.9 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143', 'Content-MD5': 'm6ZL89mWLVb6x75m8iM0rQ==', 'Expect': '100-continue'}, 'body': <_io.BytesIO object at 0x000001902208D8F0>, 'auth_path': '/anarix-cpi/NAPQUEEN/asin_keyword_id_mapping.csv', 'url': 'https://anarix-cpi.s3.amazonaws.com/NAPQUEEN/asin_keyword_id_mapping.csv', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x0000019057C37F10>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'anarix-cpi', 'params': {'Bucket': 'anarix-cpi', 'Key': 'NAPQUEEN/asin_keyword_id_mapping.csv', 'Body': <_io.BytesIO object at 0x000001902208D8F0>}}, 'input_params': {'Bucket': 'anarix-cpi', 'Key': 'NAPQUEEN/asin_keyword_id_mapping.csv'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-11-26 14:29:58,185 - botocore.hooks - DEBUG - Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x0000019000659C50>>
2024-11-26 14:29:58,186 - botocore.hooks - DEBUG - Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x0000019056A7E910>>
2024-11-26 14:29:58,186 - botocore.hooks - DEBUG - Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x00000190569CBB00>
2024-11-26 14:29:58,186 - botocore.hooks - DEBUG - Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x00000190569EA160>
2024-11-26 14:29:58,186 - botocore.hooks - DEBUG - Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x000001900066D6D0>>
2024-11-26 14:29:58,186 - __main__ - ERROR - Failed to save asin_keyword_id_mapping.csv to S3: Unable to locate credentials
2024-11-26 14:29:59,670 - botocore.credentials - DEBUG - Looking for credentials via: env
2024-11-26 14:29:59,670 - botocore.credentials - DEBUG - Looking for credentials via: assume-role
2024-11-26 14:29:59,671 - botocore.credentials - DEBUG - Looking for credentials via: assume-role-with-web-identity
2024-11-26 14:29:59,671 - botocore.credentials - DEBUG - Looking for credentials via: sso
2024-11-26 14:29:59,672 - botocore.credentials - DEBUG - Looking for credentials via: shared-credentials-file
2024-11-26 14:29:59,672 - botocore.credentials - DEBUG - Looking for credentials via: custom-process
2024-11-26 14:29:59,672 - botocore.credentials - DEBUG - Looking for credentials via: config-file
2024-11-26 14:29:59,673 - botocore.credentials - DEBUG - Looking for credentials via: ec2-credentials-file
2024-11-26 14:29:59,673 - botocore.credentials - DEBUG - Looking for credentials via: boto-config
2024-11-26 14:29:59,673 - botocore.credentials - DEBUG - Looking for credentials via: container-role
2024-11-26 14:29:59,674 - botocore.credentials - DEBUG - Looking for credentials via: iam-role
2024-11-26 14:29:59,674 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (3): 169.254.169.254:80
2024-11-26 14:30:00,681 - botocore.utils - DEBUG - Caught retryable HTTP exception while making metadata service request to http://169.254.169.254/latest/api/token: Connect timeout on endpoint URL: "http://169.254.169.254/latest/api/token"
Traceback (most recent call last):
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: timed out

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\httpsession.py", line 464, in send
    urllib_response = conn.urlopen(
                      ^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connectionpool.py", line 847, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\retry.py", line 445, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connectionpool.py", line 793, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connectionpool.py", line 496, in _make_request
    conn.request(
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\awsrequest.py", line 96, in request
    rval = super().request(method, url, body, headers, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 400, in request
    self.endheaders()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\client.py", line 1298, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\awsrequest.py", line 123, in _send_output
    self.send(msg)
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\awsrequest.py", line 223, in send
    return super().send(str)
           ^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\client.py", line 996, in send
    self.connect()
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 238, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 207, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<botocore.awsrequest.AWSHTTPConnection object at 0x000001900063A190>, 'Connection to 169.254.169.254 timed out. (connect timeout=1)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\utils.py", line 458, in _fetch_metadata_token
    response = self._session.send(request.prepare())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\httpsession.py", line 499, in send
    raise ConnectTimeoutError(endpoint_url=request.url, error=e)
botocore.exceptions.ConnectTimeoutError: Connect timeout on endpoint URL: "http://169.254.169.254/latest/api/token"
2024-11-26 14:30:00,694 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (4): 169.254.169.254:80
2024-11-26 14:30:01,707 - botocore.utils - DEBUG - Caught retryable HTTP exception while making metadata service request to http://169.254.169.254/latest/meta-data/iam/security-credentials/: Connect timeout on endpoint URL: "http://169.254.169.254/latest/meta-data/iam/security-credentials/"
Traceback (most recent call last):
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: timed out

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\httpsession.py", line 464, in send
    urllib_response = conn.urlopen(
                      ^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connectionpool.py", line 847, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\retry.py", line 445, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connectionpool.py", line 793, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connectionpool.py", line 496, in _make_request
    conn.request(
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\awsrequest.py", line 96, in request
    rval = super().request(method, url, body, headers, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 400, in request
    self.endheaders()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\client.py", line 1298, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\awsrequest.py", line 123, in _send_output
    self.send(msg)
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\awsrequest.py", line 223, in send
    return super().send(str)
           ^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\client.py", line 996, in send
    self.connect()
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 238, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 207, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<botocore.awsrequest.AWSHTTPConnection object at 0x0000019000639F90>, 'Connection to 169.254.169.254 timed out. (connect timeout=1)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\utils.py", line 513, in _get_request
    response = self._session.send(request.prepare())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\httpsession.py", line 499, in send
    raise ConnectTimeoutError(endpoint_url=request.url, error=e)
botocore.exceptions.ConnectTimeoutError: Connect timeout on endpoint URL: "http://169.254.169.254/latest/meta-data/iam/security-credentials/"
2024-11-26 14:30:01,712 - botocore.utils - DEBUG - Max number of attempts exceeded (1) when attempting to retrieve data from metadata service.
2024-11-26 14:30:01,712 - botocore.hooks - DEBUG - Event choose-service-name: calling handler <function handle_service_name_alias at 0x00000190569A9440>
2024-11-26 14:30:01,713 - botocore.hooks - DEBUG - Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x0000019056906F20>
2024-11-26 14:30:01,713 - botocore.hooks - DEBUG - Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x000001902200ECA0>
2024-11-26 14:30:01,713 - botocore.hooks - DEBUG - Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x0000019056906CA0>
2024-11-26 14:30:01,714 - botocore.configprovider - DEBUG - Looking for endpoint for s3 via: environment_service
2024-11-26 14:30:01,714 - botocore.configprovider - DEBUG - Looking for endpoint for s3 via: environment_global
2024-11-26 14:30:01,714 - botocore.configprovider - DEBUG - Looking for endpoint for s3 via: config_service
2024-11-26 14:30:01,714 - botocore.configprovider - DEBUG - Looking for endpoint for s3 via: config_global
2024-11-26 14:30:01,715 - botocore.configprovider - DEBUG - No configured endpoint found.
2024-11-26 14:30:01,716 - botocore.endpoint - DEBUG - Setting s3 timeout as (60, 60)
2024-11-26 14:30:01,718 - botocore.client - DEBUG - Registering retry handlers for service: s3
2024-11-26 14:30:01,720 - botocore.utils - DEBUG - Registering S3 region redirector handler
2024-11-26 14:30:01,721 - botocore.utils - DEBUG - Registering S3Express Identity Resolver
2024-11-26 14:30:01,722 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x00000190569E8C20>
2024-11-26 14:30:01,723 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x00000190569CBEC0>
2024-11-26 14:30:01,723 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x00000190569E9620>
2024-11-26 14:30:01,723 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x00000190569CBE20>
2024-11-26 14:30:01,723 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x00000190569EA020>
2024-11-26 14:30:01,724 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x00000190006DCD10>>
2024-11-26 14:30:01,724 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x0000019000639950>>
2024-11-26 14:30:01,724 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x00000190569CBC40>
2024-11-26 14:30:01,724 - botocore.hooks - DEBUG - Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x00000190569EA200>
2024-11-26 14:30:01,725 - botocore.hooks - DEBUG - Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x00000190006DCD10>>
2024-11-26 14:30:01,725 - botocore.regions - DEBUG - Calling endpoint provider with parameters: {'Bucket': 'anarix-cpi', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'NAPQUEEN/keyword_x_keyword_id.csv', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-11-26 14:30:01,726 - botocore.regions - DEBUG - Endpoint provider result: https://anarix-cpi.s3.amazonaws.com
2024-11-26 14:30:01,726 - botocore.regions - DEBUG - Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-11-26 14:30:01,726 - botocore.regions - DEBUG - Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-11-26 14:30:01,726 - botocore.hooks - DEBUG - Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x0000019056843BA0>
2024-11-26 14:30:01,727 - botocore.hooks - DEBUG - Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x00000190569E8220>
2024-11-26 14:30:01,727 - botocore.handlers - DEBUG - Adding expect 100 continue header to request.
2024-11-26 14:30:01,727 - botocore.hooks - DEBUG - Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x00000190006DD9D0>>
2024-11-26 14:30:01,727 - botocore.hooks - DEBUG - Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x00000190569CA480>
2024-11-26 14:30:01,728 - botocore.hooks - DEBUG - Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x00000190569E9760>
2024-11-26 14:30:01,728 - botocore.endpoint - DEBUG - Making request for OperationModel(name=PutObject) with params: {'url_path': '/NAPQUEEN/keyword_x_keyword_id.csv', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/windows#10 md/arch#amd64 lang/python#3.11.9 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143', 'Content-MD5': '0Nsz2dLSlASrzUupcBS8aQ==', 'Expect': '100-continue'}, 'body': <_io.BytesIO object at 0x00000190006D8630>, 'auth_path': '/anarix-cpi/NAPQUEEN/keyword_x_keyword_id.csv', 'url': 'https://anarix-cpi.s3.amazonaws.com/NAPQUEEN/keyword_x_keyword_id.csv', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x00000190006EC750>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'anarix-cpi', 'params': {'Bucket': 'anarix-cpi', 'Key': 'NAPQUEEN/keyword_x_keyword_id.csv', 'Body': <_io.BytesIO object at 0x00000190006D8630>}}, 'input_params': {'Bucket': 'anarix-cpi', 'Key': 'NAPQUEEN/keyword_x_keyword_id.csv'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-11-26 14:30:01,729 - botocore.hooks - DEBUG - Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x00000190006EC710>>
2024-11-26 14:30:01,730 - botocore.hooks - DEBUG - Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x0000019000639950>>
2024-11-26 14:30:01,730 - botocore.hooks - DEBUG - Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x00000190569CBB00>
2024-11-26 14:30:01,730 - botocore.hooks - DEBUG - Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x00000190569EA160>
2024-11-26 14:30:01,731 - botocore.hooks - DEBUG - Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x00000190006DD9D0>>
2024-11-26 14:30:01,731 - __main__ - ERROR - Failed to save keyword_x_keyword_id.csv to S3: Unable to locate credentials
2024-11-26 14:30:01,732 - __main__ - INFO - Process 3: Product Price Data fetched and files saved to S3
2024-11-26 14:30:19,837 - __main__ - INFO - Executed price tracker query successfully.
2024-11-26 14:30:20,226 - __main__ - INFO - Data fetched and processed into DataFrame.
2024-11-26 14:30:20,228 - __main__ - INFO - Process 4: Finding Brand's Sales Data
2024-11-26 14:30:20,228 - botocore.credentials - DEBUG - Looking for credentials via: env
2024-11-26 14:30:20,229 - botocore.credentials - DEBUG - Looking for credentials via: assume-role
2024-11-26 14:30:20,229 - botocore.credentials - DEBUG - Looking for credentials via: assume-role-with-web-identity
2024-11-26 14:30:20,229 - botocore.credentials - DEBUG - Looking for credentials via: sso
2024-11-26 14:30:20,230 - botocore.credentials - DEBUG - Looking for credentials via: shared-credentials-file
2024-11-26 14:30:20,230 - botocore.credentials - DEBUG - Looking for credentials via: custom-process
2024-11-26 14:30:20,230 - botocore.credentials - DEBUG - Looking for credentials via: config-file
2024-11-26 14:30:20,231 - botocore.credentials - DEBUG - Looking for credentials via: ec2-credentials-file
2024-11-26 14:30:20,231 - botocore.credentials - DEBUG - Looking for credentials via: boto-config
2024-11-26 14:30:20,231 - botocore.credentials - DEBUG - Looking for credentials via: container-role
2024-11-26 14:30:20,231 - botocore.credentials - DEBUG - Looking for credentials via: iam-role
2024-11-26 14:30:20,231 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (5): 169.254.169.254:80
2024-11-26 14:30:21,244 - botocore.utils - DEBUG - Caught retryable HTTP exception while making metadata service request to http://169.254.169.254/latest/api/token: Connect timeout on endpoint URL: "http://169.254.169.254/latest/api/token"
Traceback (most recent call last):
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: timed out

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\httpsession.py", line 464, in send
    urllib_response = conn.urlopen(
                      ^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connectionpool.py", line 847, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\retry.py", line 445, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connectionpool.py", line 793, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connectionpool.py", line 496, in _make_request
    conn.request(
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\awsrequest.py", line 96, in request
    rval = super().request(method, url, body, headers, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 400, in request
    self.endheaders()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\client.py", line 1298, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\awsrequest.py", line 123, in _send_output
    self.send(msg)
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\awsrequest.py", line 223, in send
    return super().send(str)
           ^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\client.py", line 996, in send
    self.connect()
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 238, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 207, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<botocore.awsrequest.AWSHTTPConnection object at 0x0000019000639190>, 'Connection to 169.254.169.254 timed out. (connect timeout=1)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\utils.py", line 458, in _fetch_metadata_token
    response = self._session.send(request.prepare())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\httpsession.py", line 499, in send
    raise ConnectTimeoutError(endpoint_url=request.url, error=e)
botocore.exceptions.ConnectTimeoutError: Connect timeout on endpoint URL: "http://169.254.169.254/latest/api/token"
2024-11-26 14:30:21,253 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (6): 169.254.169.254:80
2024-11-26 14:30:22,265 - botocore.utils - DEBUG - Caught retryable HTTP exception while making metadata service request to http://169.254.169.254/latest/meta-data/iam/security-credentials/: Connect timeout on endpoint URL: "http://169.254.169.254/latest/meta-data/iam/security-credentials/"
Traceback (most recent call last):
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: timed out

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\httpsession.py", line 464, in send
    urllib_response = conn.urlopen(
                      ^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connectionpool.py", line 847, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\retry.py", line 445, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connectionpool.py", line 793, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connectionpool.py", line 496, in _make_request
    conn.request(
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\awsrequest.py", line 96, in request
    rval = super().request(method, url, body, headers, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 400, in request
    self.endheaders()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\client.py", line 1298, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\awsrequest.py", line 123, in _send_output
    self.send(msg)
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\awsrequest.py", line 223, in send
    return super().send(str)
           ^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\client.py", line 996, in send
    self.connect()
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 238, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\urllib3\connection.py", line 207, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<botocore.awsrequest.AWSHTTPConnection object at 0x0000019028818D10>, 'Connection to 169.254.169.254 timed out. (connect timeout=1)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\utils.py", line 513, in _get_request
    response = self._session.send(request.prepare())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bande\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\botocore\httpsession.py", line 499, in send
    raise ConnectTimeoutError(endpoint_url=request.url, error=e)
botocore.exceptions.ConnectTimeoutError: Connect timeout on endpoint URL: "http://169.254.169.254/latest/meta-data/iam/security-credentials/"
2024-11-26 14:30:22,278 - botocore.utils - DEBUG - Max number of attempts exceeded (1) when attempting to retrieve data from metadata service.
2024-11-26 14:30:22,279 - botocore.hooks - DEBUG - Event choose-service-name: calling handler <function handle_service_name_alias at 0x00000190569A9440>
2024-11-26 14:30:22,280 - botocore.hooks - DEBUG - Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x0000019056906F20>
2024-11-26 14:30:22,280 - botocore.hooks - DEBUG - Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x000001902200ECA0>
2024-11-26 14:30:22,280 - botocore.hooks - DEBUG - Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x0000019056906CA0>
2024-11-26 14:30:22,280 - botocore.configprovider - DEBUG - Looking for endpoint for s3 via: environment_service
2024-11-26 14:30:22,280 - botocore.configprovider - DEBUG - Looking for endpoint for s3 via: environment_global
2024-11-26 14:30:22,280 - botocore.configprovider - DEBUG - Looking for endpoint for s3 via: config_service
2024-11-26 14:30:22,281 - botocore.configprovider - DEBUG - Looking for endpoint for s3 via: config_global
2024-11-26 14:30:22,281 - botocore.configprovider - DEBUG - No configured endpoint found.
2024-11-26 14:30:22,284 - botocore.endpoint - DEBUG - Setting s3 timeout as (60, 60)
2024-11-26 14:30:22,286 - botocore.client - DEBUG - Registering retry handlers for service: s3
2024-11-26 14:30:22,287 - botocore.utils - DEBUG - Registering S3 region redirector handler
2024-11-26 14:30:22,287 - botocore.utils - DEBUG - Registering S3Express Identity Resolver
2024-11-26 14:30:22,951 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x00000190569E8C20>
2024-11-26 14:30:22,952 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x00000190569CBEC0>
2024-11-26 14:30:22,952 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x00000190569E9620>
2024-11-26 14:30:22,958 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x00000190569CBE20>
2024-11-26 14:30:22,958 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x00000190569EA020>
2024-11-26 14:30:22,959 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x00000190288377D0>>
2024-11-26 14:30:22,959 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x0000019028806E50>>
2024-11-26 14:30:22,959 - botocore.hooks - DEBUG - Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x00000190569CBC40>
2024-11-26 14:30:22,959 - botocore.hooks - DEBUG - Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x00000190569EA200>
2024-11-26 14:30:22,959 - botocore.hooks - DEBUG - Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x00000190288377D0>>
2024-11-26 14:30:22,960 - botocore.regions - DEBUG - Calling endpoint provider with parameters: {'Bucket': 'anarix-cpi', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'NAPQUEEN/price_tracker_data.csv', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-11-26 14:30:22,960 - botocore.regions - DEBUG - Endpoint provider result: https://anarix-cpi.s3.amazonaws.com
2024-11-26 14:30:22,961 - botocore.regions - DEBUG - Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-11-26 14:30:22,961 - botocore.regions - DEBUG - Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-11-26 14:30:22,963 - botocore.hooks - DEBUG - Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x0000019056843BA0>
2024-11-26 14:30:22,989 - botocore.hooks - DEBUG - Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x00000190569E8220>
2024-11-26 14:30:22,989 - botocore.handlers - DEBUG - Adding expect 100 continue header to request.
2024-11-26 14:30:22,990 - botocore.hooks - DEBUG - Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x0000019028838510>>
2024-11-26 14:30:22,990 - botocore.hooks - DEBUG - Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x00000190569CA480>
2024-11-26 14:30:22,990 - botocore.hooks - DEBUG - Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x00000190569E9760>
2024-11-26 14:30:22,991 - botocore.endpoint - DEBUG - Making request for OperationModel(name=PutObject) with params: {'url_path': '/NAPQUEEN/price_tracker_data.csv', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/windows#10 md/arch#amd64 lang/python#3.11.9 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143', 'Content-MD5': 'SGvQLAPcrZ/a/po10i5LWw==', 'Expect': '100-continue'}, 'body': <_io.BytesIO object at 0x00000190294E4E00>, 'auth_path': '/anarix-cpi/NAPQUEEN/price_tracker_data.csv', 'url': 'https://anarix-cpi.s3.amazonaws.com/NAPQUEEN/price_tracker_data.csv', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x000001902882F6D0>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'anarix-cpi', 'params': {'Bucket': 'anarix-cpi', 'Key': 'NAPQUEEN/price_tracker_data.csv', 'Body': <_io.BytesIO object at 0x00000190294E4E00>}}, 'input_params': {'Bucket': 'anarix-cpi', 'Key': 'NAPQUEEN/price_tracker_data.csv'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-11-26 14:30:22,991 - botocore.hooks - DEBUG - Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x000001902882F690>>
2024-11-26 14:30:22,992 - botocore.hooks - DEBUG - Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x0000019028806E50>>
2024-11-26 14:30:22,992 - botocore.hooks - DEBUG - Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x00000190569CBB00>
2024-11-26 14:30:22,992 - botocore.hooks - DEBUG - Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x00000190569EA160>
2024-11-26 14:30:22,992 - botocore.hooks - DEBUG - Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x0000019028838510>>
2024-11-26 14:30:22,993 - __main__ - ERROR - Failed to save price_tracker_data.csv to S3: Unable to locate credentials
2024-11-26 14:30:50,020 - __main__ - INFO - After removing napqueen products : 
2024-11-26 14:31:10,352 - __main__ - INFO - After adding back napqueen products :
2024-11-26 14:33:28,386 - __main__ - INFO - Processed ASIN data for 2024-11-26
2024-11-26 14:33:32,826 - __main__ - INFO - Processed ASIN data for 2024-11-25
2024-11-26 14:33:37,133 - __main__ - INFO - Processed ASIN data for 2024-11-24
2024-11-26 14:33:41,519 - __main__ - INFO - Processed ASIN data for 2024-11-23
2024-11-26 14:33:45,861 - __main__ - INFO - Processed ASIN data for 2024-11-22
2024-11-26 14:33:50,429 - __main__ - INFO - Processed ASIN data for 2024-11-21
2024-11-26 14:33:54,960 - __main__ - INFO - Processed ASIN data for 2024-11-20
2024-11-26 14:33:59,525 - __main__ - INFO - Processed ASIN data for 2024-11-19
2024-11-26 14:34:04,275 - __main__ - INFO - Processed ASIN data for 2024-11-18
2024-11-26 14:34:08,962 - __main__ - INFO - Processed ASIN data for 2024-11-17
2024-11-26 14:34:13,928 - __main__ - INFO - Processed ASIN data for 2024-11-16
2024-11-26 14:34:18,737 - __main__ - INFO - Processed ASIN data for 2024-11-15
2024-11-26 14:34:23,476 - __main__ - INFO - Processed ASIN data for 2024-11-14
2024-11-26 14:34:28,239 - __main__ - INFO - Processed ASIN data for 2024-11-13
2024-11-26 14:34:33,353 - __main__ - INFO - Processed ASIN data for 2024-11-12
2024-11-26 14:34:38,685 - __main__ - INFO - Processed ASIN data for 2024-11-11
2024-11-26 14:34:44,729 - __main__ - INFO - Processed ASIN data for 2024-11-10
2024-11-26 14:34:50,871 - __main__ - INFO - Processed ASIN data for 2024-11-09
2024-11-26 14:34:56,982 - __main__ - INFO - Processed ASIN data for 2024-11-08
2024-11-26 14:35:03,084 - __main__ - INFO - Processed ASIN data for 2024-11-07
2024-11-26 14:35:09,342 - __main__ - INFO - Processed ASIN data for 2024-11-06
2024-11-26 14:35:15,533 - __main__ - INFO - Processed ASIN data for 2024-11-05
2024-11-26 14:35:21,867 - __main__ - INFO - Processed ASIN data for 2024-11-04
2024-11-26 14:35:28,404 - __main__ - INFO - Processed ASIN data for 2024-11-03
2024-11-26 14:35:34,571 - __main__ - INFO - Processed ASIN data for 2024-11-02
2024-11-26 14:35:41,036 - __main__ - INFO - Processed ASIN data for 2024-11-01
2024-11-26 14:35:47,653 - __main__ - INFO - Processed ASIN data for 2024-10-31
2024-11-26 14:35:54,815 - __main__ - INFO - Processed ASIN data for 2024-10-30
2024-11-26 14:36:02,364 - __main__ - INFO - Processed ASIN data for 2024-10-29
2024-11-26 14:36:10,287 - __main__ - INFO - Processed ASIN data for 2024-10-28
2024-11-26 14:36:18,469 - __main__ - INFO - Processed ASIN data for 2024-10-27
2024-11-26 14:36:26,643 - __main__ - INFO - Processed ASIN data for 2024-10-26
2024-11-26 14:36:35,092 - __main__ - INFO - Processed ASIN data for 2024-10-25
2024-11-26 14:36:43,440 - __main__ - INFO - Processed ASIN data for 2024-10-24
2024-11-26 14:36:51,767 - __main__ - INFO - Processed ASIN data for 2024-10-23
2024-11-26 14:36:59,785 - __main__ - INFO - Processed ASIN data for 2024-10-22
2024-11-26 14:37:07,063 - __main__ - INFO - Processed ASIN data for 2024-10-21
2024-11-26 14:37:14,242 - __main__ - INFO - Processed ASIN data for 2024-10-20
2024-11-26 14:37:21,132 - __main__ - INFO - Processed ASIN data for 2024-10-19
2024-11-26 14:37:28,046 - __main__ - INFO - Processed ASIN data for 2024-10-18
2024-11-26 14:37:35,011 - __main__ - INFO - Processed ASIN data for 2024-10-17
2024-11-26 14:37:41,790 - __main__ - INFO - Processed ASIN data for 2024-10-16
2024-11-26 14:37:48,782 - __main__ - INFO - Processed ASIN data for 2024-10-15
2024-11-26 14:37:55,832 - __main__ - INFO - Processed ASIN data for 2024-10-14
2024-11-26 14:38:02,980 - __main__ - INFO - Processed ASIN data for 2024-10-13
2024-11-26 14:38:09,635 - __main__ - INFO - Processed ASIN data for 2024-10-12
2024-11-26 14:38:16,759 - __main__ - INFO - Processed ASIN data for 2024-10-11
2024-11-26 14:38:23,775 - __main__ - INFO - Processed ASIN data for 2024-10-10
2024-11-26 14:38:30,241 - __main__ - INFO - Processed ASIN data for 2024-10-09
2024-11-26 14:38:35,113 - __main__ - INFO - Processed ASIN data for 2024-10-08
2024-11-26 14:38:39,838 - __main__ - INFO - Processed ASIN data for 2024-10-07
2024-11-26 14:38:45,573 - __main__ - INFO - Processed ASIN data for 2024-10-06
2024-11-26 14:38:51,860 - __main__ - INFO - Processed ASIN data for 2024-10-05
2024-11-26 14:38:57,456 - __main__ - INFO - Processed ASIN data for 2024-10-04
2024-11-26 14:39:03,193 - __main__ - INFO - Processed ASIN data for 2024-10-03
2024-11-26 14:39:06,917 - __main__ - INFO - Processed ASIN data for 2024-10-02
2024-11-26 14:39:10,110 - __main__ - INFO - Processed ASIN data for 2024-10-01
2024-11-26 14:39:13,097 - __main__ - INFO - Processed ASIN data for 2024-09-30
2024-11-26 14:39:15,689 - __main__ - INFO - Processed ASIN data for 2024-09-29
2024-11-26 14:39:17,895 - __main__ - INFO - Processed ASIN data for 2024-09-28
2024-11-26 14:39:18,964 - __main__ - INFO - Process 5: Pre-Cleaning Data
2024-11-26 14:41:56,442 - __main__ - INFO - Process 6: Post-Cleaning Data
